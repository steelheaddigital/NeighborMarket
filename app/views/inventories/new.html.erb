<h2>New Inventory Item</h2>
<div class="row-fluid"
  <div class="span6">
    <%= form_for(@inventory, :html => { :class => 'well span6' }) do |f| %>
    <%= f.error_messages %>
      <div>
        <%= f.label "Top Level Category *"   %>
        <%= f.collection_select(:top_level_category_id, @top_level_categories, :id, :name, {:include_blank => true}) %>
      </div>
      <div>
        <%= f.label "Second Level Category *" %>
        <%= f.select(:second_level_category_id, @second_level_categories.collect{|u| [u.name, u.id]}, {:include_blank => true})  %>
      </div>
      <div>
        <%= f.label :name %>
        <%= f.text_field :name %>
      </div>
      <div>
        <%= f.label "Price *" %>
        <%= f.text_field :price, :class => "input-small" %>
        <label style="display:inline-block;">per</label>
        <div style="display:inline-block">
          <%= f.select(:price_unit, {"each" => "each","lb." => "lb."}, {}, :class => "input-small") %>
        </div>
      </div>
      <div>
        <%= f.label "Quantity Available *" %>
        <%= f.text_field :quantity_available %>
      </div>
      <div>
        <%= f.label :description %>
        <%= f.text_area :description, :size => "10x10" %>
      </div>

      <%= f.hidden_field :user_id, :value => @user_id %>

      <%= f.submit("Submit", :class => 'btn') %>
    <%  end %>
  </div>
</div>

<script type="text/javascript">
  
  $(document).on("change", "#inventory_top_level_category_id", function() {
    
    var url = '/inventories/get_second_level_category'
    var data = {id:$(this).val()};
    
    $.get(url ,data, function(data){
      $("#inventory_second_level_category_id").empty();
      $("#inventory_second_level_category_id").append("<option value=\"\" selected=\"selected\"></option>");
      $.each(data, function(index, value) {
        $("#inventory_second_level_category_id").append("<option value = " + value.id + ">" + value.description + "</option>");
      });
      $("#inventory_second_level_category_id").removeAttr("disabled");
    });
  });
  
  $(document).on("submit", "#new_inventory", function(){
    var postData = $(this).serialize();
    var url = $(this).attr("action");
    $.post(url, postData, function(data){
      $("#SellerContent").html(data);
    });
    return false;
  });
  
</script>
