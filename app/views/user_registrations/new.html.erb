<h2>Sign up</h2>
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <p class="notice"><%= flash[:notice] %></p>
  <%= flash[:alert] %>
  <%= devise_error_messages! %>

  <div><%= f.label "User Name*" %>
  <%= f.text_field :username %></div>

  <div><%= f.label "Email*" %>
  <%= f.email_field :email %></div>
 
  <div><%= f.label "Password*" %>
  <%= f.password_field :password %></div>

  <div><%= f.label "Password Confirmation*" %>
  <%= f.password_field :password_confirmation %></div>

  <div><%= f.label "First name*" %>
  <%= f.text_field :first_name %></div>

  <div><%= f.label "Last name*" %>
  <%= f.text_field :last_name %></div>

  <div><%= f.label "Initial*" %>
  <%= f.text_field :initial %></div>

  <div>
    <%if params[:user][:user_type] == "seller"%>
      <%= f.label "Phone*" %>
    <% else %>
      <%= f.label "Phone" %>
    <% end %>
    <%= f.telephone_field :phone %>
  </div>  
  
  <div><%= f.label "Address*" %>
  <%= f.text_field :address %></div>

  <div><%= f.label "City*" %>
  <%= f.text_field :city %></div>
  
  <div><%= f.label "Country*" %>
  <%= f.country_select(:country, "US") %></div>

  <div><%= f.label "State*" %>
  <%= f.state_select :state %></div>

  <div><%= f.label "Zip*" %>
  <%= f.text_field :zip %></div>

  <div><%= f.label "About Me" %>
  <%= f.text_area :aboutme %></div>
  
  <% resource.roles.each do |role| %>
    <% rolable_type = params[:user][:user_type] %>
    <%= fields_for role.rolable do |rf| %>
      <% render :partial => "#{rolable_type.downcase.underscore}_fields", :locals => { :f => rf } %>
    <% end %>
  <% end %>
  
  <%= f.fields_for :roles do |rf| %>
    <%= rf.fields_for :buyer do |s|  %>
      <% render :partial => "buyer_fields", :locals => { :f => s } %>
    <% end %>
  <% end %>

  <%= f.fields_for :roles do |rf| %>
    <%= rf.fields_for :seller do |b|  %>
      <% render :partial => "seller_fields", :locals => { :f => b } %>
    <% end %>
  <% end %>
    
  <%= f.fields_for :roles do |rf| %>
    <%= rf.fields_for :manager do |b|  %>
      <% render :partial => "manager_fields", :locals => { :f => b } %>
    <% end %>
  <% end %>

  <%= hidden_field :user, :user_type, :value => params[:user][:user_type] %>
  <% # customized code end %>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render :partial => "devise/shared/links" %>
