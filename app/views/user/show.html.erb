<%
#
#Copyright 2013 Neighbor Market
#
#This file is part of Neighbor Market.
#
#Neighbor Market is free software: you can redistribute it and/or modify
#it under the terms of the GNU General Public License as published by
#the Free Software Foundation, either version 3 of the License, or
#(at your option) any later version.
#
#Neighbor Market is distributed in the hope that it will be useful,
#but WITHOUT ANY WARRANTY; without even the implied warranty of
#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#GNU General Public License for more details.
#
#You should have received a copy of the GNU General Public License
#along with Neighbor Market.  If not, see <http://www.gnu.org/licenses/>.
#
%>

<% content_for :open_graph_tags  do %>
	<meta property="og:title" content="<%= @user.username %>" />
	<meta property="og:site_name" content="<%= SiteSetting.first.site_name %>" />
	<meta property="og:url" content="<%= user_url(@user) %>" />
	<meta property="og:description" content="<%= @user.aboutme %>" />
	<meta property="og:image" content="<%= URI.join(request.url, @user.photo.url) %>" />
	<meta property="og:app_id" content="<%= SiteSetting.first.facebook_app_id %>" />
	<meta property="og:type" content="profile" />
<% end %>
<div class="container-fluid">
	<div class="row">
	    <div class="col-md-12">
	        <h1><%= @user.username %></h1>
	    </div>
	</div>
  <div class="row">
    <div class="col-md-7">
        <p>
          <%= @user.aboutme %>
        </p>
		<%if SiteSetting.first.facebook_enabled%>
			<p><span class="fb-share-button" data-href="<%= user_url(@user) %>", data-layout="button"></span></p>
		<%end%>
		<div class="itemCountContainer">
			<h3><%=@items_for_display.count%> Current Items</h3>
		</div>
		<div>
			<%@items_for_display.each_slice(3) do |slice|%>
				<div class="row thumbnailRow">
					<%slice.each do |item|%>
						<div class="col-md-4">
						    <div class="thumbnail">
						      <a href="<%=inventory_item_path(item)%>"><%= image_tag item.photo.url(:medium), {style: "height: 150px; width: auto;"} %></a>
						      <div class="caption">
						        <h3><%=link_to(item.name, inventory_item_path(item))%></h3>
						      </div>
						    </div>
						</div>
					<%end%>
				</div>
			<%end%>
		</div>
    </div>
    <div class="col-md-5">
		<div>
  	      <%if @user.photo?%>
  	          <%= image_tag @user.photo.url(:medium), {class: "img-rounded"} %>
  	      <%end%>
  		</div>
		<div style="margin-top: 10px;">
			<button class="btn btn-primary" style="width: 300px;" data-toggle="modal" data-target="#ContactModal">
			  <%="Contact #{@user.username}"%>
			</button>
		<div>
    </div>
  </div>
</div>
<div class="modal fade" id="ContactModal" tabindex="-1" role="dialog" aria-labelledby="ContactModalLabel" aria-hidden="true">
	<%= render :partial => "contact", :locals => {message: @message}%>
</div>
<script>
$(function() {
    $.getScript('//connect.facebook.net/en_US/sdk.js', function(){
      FB.init({
        appId: '<%= SiteSetting.first.facebook_app_id %>',
      	version    : 'v2.0',
		xfbml      : true
      });
    });
})
</script>
